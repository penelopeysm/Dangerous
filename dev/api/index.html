<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API documentation · Do not enter!</title><meta name="title" content="API documentation · Do not enter!"/><meta property="og:title" content="API documentation · Do not enter!"/><meta property="twitter:title" content="API documentation · Do not enter!"/><meta name="description" content="Documentation for Do not enter!."/><meta property="og:description" content="Documentation for Do not enter!."/><meta property="twitter:description" content="Documentation for Do not enter!."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Do not enter!</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Dangerous.jl</a></li><li class="is-active"><a class="tocitem" href>API documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API documentation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/penelopeysm/Dangerous.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/penelopeysm/Dangerous.jl/blob/main/docs/src/api/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-documentation"><a class="docs-heading-anchor" href="#API-documentation">API documentation</a><a id="API-documentation-1"></a><a class="docs-heading-anchor-permalink" href="#API-documentation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.MagneticField" href="#Dangerous.MagneticField"><code>Dangerous.MagneticField</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dangerous.MagneticField{T, U}</code></pre><p>A supertype for quantities and levels of dimension <code>𝐌 * 𝐈 ^ -1 * 𝐓 ^ -2</code> with a value of type <code>T</code> and units <code>U</code>.</p><p>See also: <code>Unitful.Quantity</code>, <code>Unitful.Level</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PainterQubits/Unitful.jl/blob/v1.21.0/src/user.jl#L164-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.Magnetogyric" href="#Dangerous.Magnetogyric"><code>Dangerous.Magnetogyric</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dangerous.Magnetogyric{T, U}</code></pre><p>A supertype for quantities and levels of dimension <code>𝐈 * 𝐓 * 𝐌 ^ -1</code> with a value of type <code>T</code> and units <code>U</code>.</p><p>See also: <code>Unitful.Quantity</code>, <code>Unitful.Level</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PainterQubits/Unitful.jl/blob/v1.21.0/src/user.jl#L164-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.MagnetogyricAngular" href="#Dangerous.MagnetogyricAngular"><code>Dangerous.MagnetogyricAngular</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dangerous.MagnetogyricAngular{T, U}</code></pre><p>A supertype for quantities and levels of dimension <code>𝐀 * 𝐈 * 𝐓 * 𝐌 ^ -1</code> with a value of type <code>T</code> and units <code>U</code>.</p><p>See also: <code>Unitful.Quantity</code>, <code>Unitful.Level</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PainterQubits/Unitful.jl/blob/v1.21.0/src/user.jl#L164-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.σ_x" href="#Dangerous.σ_x"><code>Dangerous.σ_x</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">σ_x</code></pre><p>Single-spin Pauli matrix.</p><p class="math-container">\[\sigma_x = \frac{1}{2}\begin{pmatrix}0 &amp; 1 \\ 1 &amp; 0\end{pmatrix}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/hamiltonian.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.σ_y" href="#Dangerous.σ_y"><code>Dangerous.σ_y</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">σ_y</code></pre><p>Single-spin Pauli matrix.</p><p class="math-container">\[\sigma_y = \frac{1}{2}\begin{pmatrix}0 &amp; -\mathrm{i} \\ \mathrm{i} &amp; 0\end{pmatrix}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/hamiltonian.jl#L12-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.σ_z" href="#Dangerous.σ_z"><code>Dangerous.σ_z</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">σ_z</code></pre><p>Single-spin Pauli matrix.</p><p class="math-container">\[\sigma_z = \frac{1}{2}\begin{pmatrix}1 &amp; 0 \\ 0 &amp; -1\end{pmatrix}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/hamiltonian.jl#L23-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.MagneticFieldFreeUnits" href="#Dangerous.MagneticFieldFreeUnits"><code>Dangerous.MagneticFieldFreeUnits</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dangerous.MagneticFieldFreeUnits{U}</code></pre><p>A supertype for <code>Unitful.FreeUnits</code> of dimension <code>𝐌 * 𝐈 ^ -1 * 𝐓 ^ -2</code>. Equivalent to <code>Unitful.FreeUnits{U, 𝐌 * 𝐈 ^ -1 * 𝐓 ^ -2}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PainterQubits/Unitful.jl/blob/v1.21.0/src/user.jl#L166-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.MagneticFieldUnits" href="#Dangerous.MagneticFieldUnits"><code>Dangerous.MagneticFieldUnits</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dangerous.MagneticFieldUnits{U}</code></pre><p>A supertype for units of dimension <code>𝐌 * 𝐈 ^ -1 * 𝐓 ^ -2</code>. Equivalent to <code>Unitful.Units{U, 𝐌 * 𝐈 ^ -1 * 𝐓 ^ -2}</code>.</p><p>See also: <code>Unitful.Units</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PainterQubits/Unitful.jl/blob/v1.21.0/src/user.jl#L165-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.MagnetogyricAngularFreeUnits" href="#Dangerous.MagnetogyricAngularFreeUnits"><code>Dangerous.MagnetogyricAngularFreeUnits</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dangerous.MagnetogyricAngularFreeUnits{U}</code></pre><p>A supertype for <code>Unitful.FreeUnits</code> of dimension <code>𝐀 * 𝐈 * 𝐓 * 𝐌 ^ -1</code>. Equivalent to <code>Unitful.FreeUnits{U, 𝐀 * 𝐈 * 𝐓 * 𝐌 ^ -1}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PainterQubits/Unitful.jl/blob/v1.21.0/src/user.jl#L166-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.MagnetogyricAngularUnits" href="#Dangerous.MagnetogyricAngularUnits"><code>Dangerous.MagnetogyricAngularUnits</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dangerous.MagnetogyricAngularUnits{U}</code></pre><p>A supertype for units of dimension <code>𝐀 * 𝐈 * 𝐓 * 𝐌 ^ -1</code>. Equivalent to <code>Unitful.Units{U, 𝐀 * 𝐈 * 𝐓 * 𝐌 ^ -1}</code>.</p><p>See also: <code>Unitful.Units</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PainterQubits/Unitful.jl/blob/v1.21.0/src/user.jl#L165-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.MagnetogyricFreeUnits" href="#Dangerous.MagnetogyricFreeUnits"><code>Dangerous.MagnetogyricFreeUnits</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dangerous.MagnetogyricFreeUnits{U}</code></pre><p>A supertype for <code>Unitful.FreeUnits</code> of dimension <code>𝐈 * 𝐓 * 𝐌 ^ -1</code>. Equivalent to <code>Unitful.FreeUnits{U, 𝐈 * 𝐓 * 𝐌 ^ -1}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PainterQubits/Unitful.jl/blob/v1.21.0/src/user.jl#L166-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.MagnetogyricUnits" href="#Dangerous.MagnetogyricUnits"><code>Dangerous.MagnetogyricUnits</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dangerous.MagnetogyricUnits{U}</code></pre><p>A supertype for units of dimension <code>𝐈 * 𝐓 * 𝐌 ^ -1</code>. Equivalent to <code>Unitful.Units{U, 𝐈 * 𝐓 * 𝐌 ^ -1}</code>.</p><p>See also: <code>Unitful.Units</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PainterQubits/Unitful.jl/blob/v1.21.0/src/user.jl#L165-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.Nucleus" href="#Dangerous.Nucleus"><code>Dangerous.Nucleus</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Nucleus</code></pre><p>The nuclei that we can simulate. These are all spin-1/2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/nuclei.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.SpinSystemState" href="#Dangerous.SpinSystemState"><code>Dangerous.SpinSystemState</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SpinSystemState(ρ_0, U)</code></pre><p>This struct holds the state of a spin system, but without explicitly propagating the density matrix. Instead, the initial density matrix and the accumulated propagator are separately stored. Only at the end of the pulse sequence is the propagation performed. This allows us to halve the number of matrix multiplications being done.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/pulse_sequence.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.SpinSystemState-Tuple{Any}" href="#Dangerous.SpinSystemState-Tuple{Any}"><code>Dangerous.SpinSystemState</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SpinSystemState(ρ_0)</code></pre><p>Create a <code>SpinSystemState</code> with an initial density matrix <code>ρ_0</code> and no propagation yet (i.e. <code>U</code> is the identity matrix).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/pulse_sequence.jl#L15-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.System" href="#Dangerous.System"><code>Dangerous.System</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">System(
    magnetic_field::MagneticField,
    transmitter_offset::Dict{Nucleus, Real},
    nuclei::Vector{Nucleus},
    chemical_shifts::Vector{&lt;:Real},
    couplings::Matrix{&lt;:Frequency}
)</code></pre><p>A complete specification of a spin system.</p><p>TODO: SFO1 and O1P are not part of the physical spin system, but rather the spectrometer / experiment setup. It should logically be moved elsewhere.</p><p><strong>Fields</strong></p><ul><li><code>magnetic_field::MagneticField</code>: The magnetic field strength, e.g. <code>22.1u&quot;T&quot;</code>.</li><li><code>transmitter_offset::Dict{Nucleus,Real}</code>: The centre of the spectrum in ppm for each nucleus.</li><li><code>nuclei::Vector{Nucleus}</code>: The nuclei in the system.</li><li><code>chemical_shifts::Vector{Float64}</code>: The chemical shifts of the nuclei in the system, in ppm. The length of this array must match the length of <code>nuclei</code>.</li><li><code>couplings::Matrix{&lt;:Frequency}</code>: The coupling constants between the nuclei in the system. The size of this matrix must be <code>(length(nuclei), length(nuclei))</code>. Note that the diagonal elements of this matrix must be zero, and for each pair of off-diagonal elements (i, j) and (j, i), one of them must be zero. The easiest way to generate this matrix is to initialise it with <code>zeros(n, n)</code>, then set the non-zero elements.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/spin_system.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.collapse-Tuple{Dangerous.SpinSystemState}" href="#Dangerous.collapse-Tuple{Dangerous.SpinSystemState}"><code>Dangerous.collapse</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">collapse(state)</code></pre><p>Collapse the intermediate spin system state by actually performing the propagation on the density matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/pulse_sequence.jl#L47-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.detect_fid-Tuple{Any, Any, Any, Union{Unitful.Quantity{T, 𝐓, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓, U}} where {L, S}} where {T, U}, Any}" href="#Dangerous.detect_fid-Tuple{Any, Any, Any, Union{Unitful.Quantity{T, 𝐓, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓, U}} where {L, S}} where {T, U}, Any}"><code>Dangerous.detect_fid</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">detect_fid(sys, nuc, ρ, dwell, npoints)</code></pre><p>Detect a free induction decay.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/pulse_sequence.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.detect_spectrum-Tuple{Any, Any, Any, Union{Unitful.Quantity{T, 𝐓, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓, U}} where {L, S}} where {T, U}, Any}" href="#Dangerous.detect_spectrum-Tuple{Any, Any, Any, Union{Unitful.Quantity{T, 𝐓, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓, U}} where {L, S}} where {T, U}, Any}"><code>Dangerous.detect_spectrum</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">detect_spectrum(sys, nuc, ρ, dwell, npoints)</code></pre><p>Detect a spectrum. Returns a tuple of the frequency axis and the spectrum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/pulse_sequence.jl#L84-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.detection_operators-Tuple{Any, Any}" href="#Dangerous.detection_operators-Tuple{Any, Any}"><code>Dangerous.detection_operators</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">detection_operators(sys, nuc)</code></pre><p>Generate the relevant operators for detecting a given nucleus:</p><p class="math-container">\[X = \sum_i I_{ix}, \quad Y = \sum_i I_{iy}\]</p><p>where the sum is over all spins of the given nucleus.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/hamiltonian.jl#L133-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.h_coupling-Tuple{Any}" href="#Dangerous.h_coupling-Tuple{Any}"><code>Dangerous.h_coupling</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">h_coupling(sys)</code></pre><p>Generate the spin–spin coupling Hamiltonian for a spin system, given by:</p><p class="math-container">\[H_{\text{coupling}} = \sum_{i \neq j} 2\pi J_{ij} (I_{ix}I_{jx} + I_{iy}I_{jy} + I_{iz}I_{jz})\]</p><p>where <span>$J_{ij}$</span> is the coupling constant between spins <code>i</code> and <code>j</code> (in Hz).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/hamiltonian.jl#L167-L177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.h_free-Tuple{Any}" href="#Dangerous.h_free-Tuple{Any}"><code>Dangerous.h_free</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">h_free(sys)</code></pre><p>Generate the free Hamiltonian for a spin system.</p><p class="math-container">\[H_{\text{free}} = H_{\text{offset}} + H_{\text{coupling}}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/hamiltonian.jl#L188-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.h_offset-Tuple{Any}" href="#Dangerous.h_offset-Tuple{Any}"><code>Dangerous.h_offset</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">h_offset(sys)</code></pre><p>Generate the offset Hamiltonian for a spin system, given by:</p><p class="math-container">\[H_{\text{offset}} = \sum_i \Omega_{0,i} I_{iz}\]</p><p>where <span>$\Omega_{0,i} = -\gamma_i B_0 - \omega_{\text{ref},i}$</span> is the offset angular frequency of spin <code>i</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/hamiltonian.jl#L150-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.h_pulse-Tuple{Any, Any, Union{Unitful.Quantity{T, 𝐓^-1, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓^-1, U}} where {L, S}} where {T, U}, Any}" href="#Dangerous.h_pulse-Tuple{Any, Any, Union{Unitful.Quantity{T, 𝐓^-1, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓^-1, U}} where {L, S}} where {T, U}, Any}"><code>Dangerous.h_pulse</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">h_pulse(sys, nuc, ω1, φ)</code></pre><p>Generate a Hamiltonian for a pulse on nucleus <code>nuc</code>, with angular frequency (<code>ω1 = B1/γ</code>) and pulse phase <code>φ</code>.</p><p>The angular frequency should be specified in rad/s. The pulse phase can be either specified as an angle in radians, or as one of the following symbols: <code>:x</code>, <code>:y</code>, <code>:_x</code>, or <code>:_y</code>, which correspond respectively to 0, π/2, π, and 3π/2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/hamiltonian.jl#L201-L211">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.op1-Tuple{Any, Any, Any}" href="#Dangerous.op1-Tuple{Any, Any, Any}"><code>Dangerous.op1</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">op1(i, n, single_spin_op)</code></pre><p>Generate a single-spin operator acting on spin <code>i</code> in a system of <code>n</code> spins.</p><p>e.g. <span>$I_{1z}$</span> in a 4-spin system is generated by <code>op1(1, 4, σ_z)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/hamiltonian.jl#L35-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.op2-NTuple{5, Any}" href="#Dangerous.op2-NTuple{5, Any}"><code>Dangerous.op2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">op2(i, j, n, single_spin_op1, single_spin_op2)</code></pre><p>Generate a two-spin operator between spins <code>i</code> and <code>j</code> in a system of <code>n</code> spins.</p><p>e.g. <span>$I_{1z}I_{2x}$</span> in a 4-spin system is generated by <code>op2(1, 2, 4, σ_z, σ_x)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/hamiltonian.jl#L58-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.propagate-Tuple{Any, Matrix{&lt;:Union{Unitful.Quantity{T, 𝐓^-1, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓^-1, U}} where {L, S}} where {T, U}}, Union{Unitful.Quantity{T, 𝐓, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓, U}} where {L, S}} where {T, U}}" href="#Dangerous.propagate-Tuple{Any, Matrix{&lt;:Union{Unitful.Quantity{T, 𝐓^-1, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓^-1, U}} where {L, S}} where {T, U}}, Union{Unitful.Quantity{T, 𝐓, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓, U}} where {L, S}} where {T, U}}"><code>Dangerous.propagate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propagate(ρ, H, t)</code></pre><p>Propagate the density matrix <code>ρ</code> under the Hamiltonian <code>H</code> for a time <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/pulse_sequence.jl#L26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.propagate-Tuple{Dangerous.SpinSystemState, Matrix{&lt;:Union{Unitful.Quantity{T, 𝐓^-1, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓^-1, U}} where {L, S}} where {T, U}}, Union{Unitful.Quantity{T, 𝐓, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓, U}} where {L, S}} where {T, U}}" href="#Dangerous.propagate-Tuple{Dangerous.SpinSystemState, Matrix{&lt;:Union{Unitful.Quantity{T, 𝐓^-1, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓^-1, U}} where {L, S}} where {T, U}}, Union{Unitful.Quantity{T, 𝐓, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐓, U}} where {L, S}} where {T, U}}"><code>Dangerous.propagate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propagate(state::SpinSystemState, H, t)</code></pre><p>Propagate the uncollapsed spin system state under the Hamiltonian <code>H</code> for a time <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/pulse_sequence.jl#L36-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.zg-NTuple{4, Any}" href="#Dangerous.zg-NTuple{4, Any}"><code>Dangerous.zg</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">zg(sys, nuc, sw, td)</code></pre><p>1D pulse–acquire experiment.</p><p><strong>Arguments</strong></p><ul><li><code>sys::</code><a href="#Dangerous.System"><code>Dangerous.System</code></a>: the spin system to simulate </li><li><code>nuc::</code><a href="#Dangerous.Nucleus"><code>Dangerous.Nucleus</code></a>: the nucleus to detect</li><li><code>sw</code>: the spectral window (in ppm)</li><li><code>td</code>: the number of points in the FID</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/pulse_sequence.jl#L108-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dangerous.ρ_eq-Tuple{Any}" href="#Dangerous.ρ_eq-Tuple{Any}"><code>Dangerous.ρ_eq</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ρ_eq(sys)</code></pre><p>Generate the thermal density matrix for a spin system. Formally, this is given by</p><p class="math-container">\[\rho_{\text{eq}} = \frac{\exp{(-\beta H)}}{\text{Tr}[(\exp{(-\beta H)]}}\]</p><p>where <span>$\beta = 1/k_\mathrm{B}T$</span>, but here we use the approximation of</p><p class="math-container">\[\rho_{\text{eq}} \propto \sum_i \gamma_i I_{iz}.\]</p><p>This is justified by the fact that <span>$H$</span> is very small (so <span>$\exp(-\beta H) \approx 1 - \beta H$</span>) and that the coupling term is small compared to the offset term.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/penelopeysm/Dangerous.jl/blob/0f16cda4ebdee6ee92f74a6cea7b46f3f6b0eddf/src/hamiltonian.jl#L105-L123">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Dangerous.jl</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Friday 26 July 2024 23:46">Friday 26 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
